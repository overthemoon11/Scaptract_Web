# ============================================
# Supabase Database Configuration
# ============================================
# For Cloud Supabase: Get these values from your Supabase project settings:
# https://app.supabase.com/project/_/settings/api
# For Local Supabase: Keys are optional (can be left empty)
SUPABASE_URL=https://your-project.supabase.co
# For local: http://localhost:6001 or http://127.0.0.1:6001

# Optional: Required for cloud Supabase, optional for local instances
SUPABASE_ANON_KEY=your_anon_key_here
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key_here

# ============================================
# Server Configuration
# ============================================
PORT=5000
CLIENT_URL=http://localhost:3000
NODE_ENV=development

# ============================================
# JWT Authentication
# ============================================
# Generate a secure random string for JWT signing
# You can use: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_SECRET=your_jwt_secret_key_here

# ============================================
# Development Mode
# ============================================
# Set to 'true' to bypass email OTP verification in development
# In dev mode, any 6-digit number will be accepted for OTP
DEVMODE=false

# ============================================
# Email Configuration (Optional)
# ============================================
# Required for email OTP verification and password reset
# For Gmail, you'll need to use an App Password (not your regular password)
# See EMAIL_SETUP.md for detailed instructions
EMAIL_USER=your_email@gmail.com
EMAIL_PASSWORD=your_app_password

# ============================================
# Tesseract OCR Configuration
# ============================================
# Path to Tesseract OCR executable
# Windows example: D:/Tesseract/tesseract.exe
# Linux/Mac example: /usr/bin/tesseract
TESSERACT_PATH=D:/Tesseract/tesseract.exe

# OCR Language (default: eng for English)
# Available languages depend on installed Tesseract language packs
# Common options: eng, spa, fra, deu, chi_sim, etc.
OCR_LANG=eng

# ============================================
# Dify AI Assistant Configuration
# ============================================
# Dify API URL (e.g., http://10.211.9.95/v1 or https://api.dify.ai/v1)
# Required: This must be set for the AI assistant to work

DIFY_API_URL=http://<IP>:<PORT>/v1
# Dify API Key (get from your Dify app settings)
# Required: This must be set for the AI assistant to work
DIFY_CHATBOT_API_KEY_V1=api-key

# ============================================
# Dify OCR Configuration
# ============================================
# Dify OCR API Key (get from your Dify OCR chatbot app settings)
# Required: This must be set for OCR text extraction to work
# Note: Dify OCR uses the same chat-messages endpoint as the chatbot,
# but with a different API key for the OCR-specific chatbot that accepts image/PDF files
DIFY_OCR_API_KEY_V1=api-key

# Dify Workflow 1 API Key (for OCR processing)
# Required if using async extraction workflow
# IMPORTANT: This MUST be an API key from a Workflow app in Dify, not a Chat/Completion app
# Get from your Dify Workflow 1 app settings (Settings > API Keys)
# The API key type determines which endpoint can be used
DIFY_OCR_API_KEY_W1=api-key

# Dify Workflow 2 API Key (for text extraction)
# Required if using async extraction workflow
# IMPORTANT: This MUST be an API key from a Workflow app in Dify
# Get from your Dify Workflow 2 app settings (Settings > API Keys)
DIFY_OCR_API_KEY_W2=api-key

# Dify Chatflow 3 API Key (for section summarization)
# Optional: If not set, will fallback to DIFY_OCR_API_KEY_W2
# IMPORTANT: This MUST be an API key from a Chatflow app in Dify
# Get from your Dify Chatflow 3 app settings (Settings > API Keys)
# The chatflow should accept inputs: { "section_key": string, "section_text": string }
# And return output in format: { "answer": "{\"section_key\": \"summary text\"}" }
# You can use either variable name (DIFY_WORKFLOW_3_API_KEY is checked first):
DIFY_WORKFLOW_3_API_KEY=api-key
# OR
DIFY_OCR_API_KEY_W3=api-key

# Dify Workflow 4 API Key (for extracting structured fields from Additional Information)
# Optional: If not set, Additional Information will remain as a single string
# IMPORTANT: This MUST be an API key from a Workflow/Chatflow app in Dify
# Get from your Dify Workflow 4 app settings (Settings > API Keys)
# The workflow should accept inputs: { "additional_information": string }
# And return output in JSON format with extracted fields (e.g., {"Author": "...", "Email": "..."})
# You can use either variable name (DIFY_WORKFLOW_4_API_KEY is checked first):
DIFY_WORKFLOW_4_API_KEY=api-key
# OR
DIFY_OCR_API_KEY_W4=api-key

# Dify Workflow 2 Webhook URL (for triggering Workflow 2 from OCR callbacks)
# Required if using async extraction workflow with webhook trigger
# Get this URL from your Dify Workflow 2:
# 1. Go to Workflow 2 in Dify Studio
# 2. Click on the Webhook Trigger node
# 3. Copy the webhook URL (format: http://your-dify-host/console/api/workflows/trigger/webhook/{workflow-id})
# Should be accessible from your server (use your public IP or domain)
DIFY_WORKFLOW_2_WEBHOOK_URL=http://your-dify-host/console/api/workflows/trigger/webhook/{workflow-id}

# Server Webhook URL (for Workflow 2 to call back with answer1 and combined_text)
# Required if using async extraction workflow
# Should be accessible from Dify (use your public IP or domain)
SERVER_WEBHOOK_URL=http://192.168.0.24:5000/api/ocr-webhook/workflow2-callback

# File Server URL (e.g., http://192.168.0.24:3000 or https://your-domain.com)
# Required: This must be set for OCR to work. Files will be accessed via remote_url method.
# The URL should point to your server where files are accessible via /api/uploads endpoint
FILE_SERVER_URL=http://<IP>:<PORT>

# OCR Internal Token (for OCR API to fetch document metadata)
# Optional: Defaults to 'ocr-internal-secret' if not set
# This token is used by the Python OCR API to authenticate when fetching document group_name and file_name
# Should be a secure random string (same value should be set in Python OCR service environment)
OCR_INTERNAL_TOKEN=ocr-internal-secret