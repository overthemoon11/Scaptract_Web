scale data, which enables the model to have strong representational capabiliis.For FER, fctNt isthelargest available in-the-wild dataset that contains more than one million face images collected from the Internet by keyword searching. Among them, about 400K images are manually labeled.We clean the dataset based on the label file and use OpenFace (Baltrusaitisetal.2018)forfacealignment, leaving 269,316 images for self-supervised training.

## Experiment 

## I mplementation 

We choose the ViT-base and do self-supervised pretraining on the AffectNet training set. The pretraining length is 300epochs and the other settings of pretraining and fine-tuning are same as MAE (He et al. 2022). Due to the tranining set of AffectNet is imbalanced whereas the validation set is balanced, oversampling strategy is used while fine-tuning. We train the ViT model on each FER training subset and then evaluate on each FER testing subset.



## Result 

We compare our method with two pretraining methods using supervised learning and MAE on ImageNet-1K in Table 1. Although AffectNet is almost 4× smaller than ImageNet1K, pretraining with MAE on AffectNet yields better fine-tuning results than both supervised learning and MAE  pretraining methods on ImageNet-1K. Our method based on ViT-base achieves the best accuracy of 90.22%, 61.73% and 89.00% on RAF-DB, AffectNet and FER-Plus respectively without any data augmentation, which gives us a powerful  pretraining model for the subsequent work. And the performance reaches 91.07 % on RAF-DB, 62.42% on AfectNet,and90.18% on FER-Plus if regular augmentation is used (random horizontal flipping, color jitter and afi ne transformation).



<div style="text-align: center;">Table 1: MAE pretraining vs. supervised pretraining, numbersevaluated byfine-tuning theViT-base weightsfrom ImageNet-1K and AffectNet on downstream FER datasets without data augmentation. </div>



<div style="text-align: center;"><html><body><table border="1"><tr><td>method</td><td> pretrain data</td><td>RAF-DB</td><td>AffectNet</td></tr><tr><td>Supervised</td><td>IN1K</td><td>85.14%</td><td>57.10%</td></tr><tr><td>MAE</td><td>IN1K</td><td>88.49%</td><td>60.87%</td></tr><tr><td>MAE</td><td>AffectNet</td><td>90.22%</td><td>61.73%</td></tr></table></body></html></div>


<div style="text-align: center;">Table 2: More ViT-based results on RAF-DB, AffectNet and FER-Plus. Here, data augmentation is employed. The variants, ViT-small and ViT-tiny are proposed in DeiT (Touvron et al. 2021). </div>



<div style="text-align: center;"><html><body><table border="1"><tr><td>method</td><td> pretrain data</td><td>ViT variants</td><td>RAF-DB</td><td>AffectNet</td><td>FER-Plus</td></tr><tr><td>Supervised</td><td>IN1K</td><td>ViT-samll</td><td>87.19%</td><td>57.91%</td><td>88.46%</td></tr><tr><td>Supervised</td><td>IN1K</td><td>ViT-tiny</td><td>87.03%</td><td>58.28%</td><td>88.56%</td></tr><tr><td>Supervised</td><td>IN1K</td><td>ViT-base</td><td>87.22%</td><td>57.99%</td><td>88.91%</td></tr><tr><td>MAE</td><td>AffectNet</td><td>Vit-base</td><td>91.07%</td><td>62.42%</td><td>90.18%</td></tr></table></body></html></div>


In addition, to demonstrate the effectiveness of our method,we compare it withtheexisting state-of-the-art methods. In Table2,SCN (Wangetal. 2020)and RUL (Zhang, Wang, and Deng 2021) adopt ResNet as the backbone and introduce different uncertainty learning methods to tackle the uncertainty problem in FER. MVT (Li et al.2021) proposes the combination of grid-wise local attention and token-based global attention to overcome the weakness of CNN-based in long-range relation modeling. Compared with these well-designed SOTA methods, our results on the three FER datasets demonstrate the effectiveness and scalability of our method.



<div style="text-align: center;">Table 3: Comparsion with the state of the art on RAF-DB,AffectNet and FER-Plus. </div>



<div style="text-align: center;"><html><body><table border="1"><tr><td>method</td><td>year T</td><td>RAF-DB</td><td>AffectNet</td><td>FER-Plus</td></tr><tr><td>SCN (Wang et al. 2020)</td><td>2020</td><td>88.14%</td><td>60.23%</td><td>89.35%</td></tr><tr><td>RUL (Zhang, Wang, and Deng 2021)</td><td>2021</td><td>88.98%</td><td>61.43%</td><td></td></tr><tr><td>MVT (Li et al. 2021)</td><td>2021</td><td>88.26%</td><td>61.40%</td><td>89.22%</td></tr><tr><td>Ours</td><td>2022</td><td>91.07%</td><td>62.42%</td><td>90.18%</td></tr></table></body></html></div>


## Conclusions 

In this paper, we demonstrate that a vanilla ViT-based backbone pretrained by MAE method (He et al. 2022) without extra data is comparable to the SOTA work. The presented method achieves 91.07% on RAF-DB, 62.42% on AfectNet,and 90.18% on FER-Plus, which can serve as a transparent ViT-based baseline for FER studies.



## References 

Baltrusaitis, T.; Zadeh, A.; Lim, Y. C.; and Morency, L.-P. 2018.Openface 2.0: Facial behavior analysis toolkit. In 2018 13th IEEE international conference on automatic face & gesture recognition (FG 2018), 59–66. IEEE.
Chen, X.; Ding, M.; Wang, X.; Xin, Y.; Mo, S.; Wang, Y.; Han,S.; Luo, P.;Zeng,G.;and Wang, J. 2022. Context autoencoder for self-supervised representation learning. arXiv preprint arXiv:2202.03026.
Dosovitskiy, A.;Beyer, L.; Kolesnikov, A.; Weissenborn, D.;Zhai, X.; Unterthiner, T.; Dehghani, M.; Minderer,M.; Heigold,G.; Gelly,S.;et al. 2020. Animage is worth 16x16 words:Transformers for image recognition at scale. arXiv preprint arXiv:2010.11929.
Gong, W.; An, Z.; and Elfi ky, N. M. 2022. Deep learning-based microexpression recognition: a survey. Neural Computing and Applications 1–24.
Guo, Y.; Zhang, L.; Hu, Y.; He, X.; and Gao, J. 2016. Ms-celeb1m: A dataset and benchmark for large-scale face recognition. In European conference on computer vision, 87-102. Springer.He, K.; Zhang, X.; Ren, S.; and Sun, J. 2016. Deep residual learning for image recognition. In Proceedings of the IEEE conference on computer vision and pattern recognition, 770–778.He, K.; Chen, X.; Xie, S.; Li, Y.; Dollar, P.; and Girshick, R. 2022.Masked autoencoders are scalable vision learners. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 16000–16009.
Hwang, H.; Kim, S.; Park, W.-J.; Seo, J.; Ko, K.; and Yeo, H. 2022.Vision transformer equipped with neural resizer on facial expression recognition task. In ICASSP_2022-2022 IEEE International 